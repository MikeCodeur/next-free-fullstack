# Gérer authentification avec Next-Auth

### 💡 Gérer l’authentification

## 📝 Tes notes

Détaille ce que tu as appris ici, sur une page [Notion](https://go.mikecodeur.com/course-notes-template)

## Comprendre

### Introduction à `NextAuth.js`

L'authentification est une partie essentielle de toute application web moderne. **`NextAuth.js`** est une solution **d'authentification complète et flexible** pour **`Next.js`**, qui permet d'ajouter rapidement des fonctionnalités de connexion à une application, sans avoir à gérer manuellement les sessions et la sécurité des `tokens`.

Avec **`NextAuth.js`**, tu peux intégrer différents **fournisseurs d'authentification** comme :

✅ **Google, GitHub, Twitter, Discord** (OAuth)

✅ **Email/password avec Magic Link**

✅ **Authentification par identifiants classiques (credentials)**

✅ **JWT et sessions sécurisées**

Dans ce module, nous allons voir **comment configurer `NextAuth.js`**, gérer les sessions, et protéger certaines pages de ton application **`Next.js`** 

📑 Le lien vers la doc [https://authjs.dev/](https://authjs.dev/)

## Exercice

Pour gagner du temps, nous avons suivi le `get-started` et les fichiers `auth.ts` et `auth-config.ts` sont la 

[https://authjs.dev/getting-started/installation?framework=next-js](https://authjs.dev/getting-started/installation?framework=next-js)

- De même que les formulaires sont maintenant connectés au `server action`

Dans cet exercice, tu vas devoir appeler les fonctions `sign-in` `sign-up` dans le server action

- Mais dans un premier temps, tu vas devoir configurer `next-auth` avec le `provider Credentials`

```tsx
providers: [
    CredentialsProvider({
      name: 'Credentials',
     
      async authorize(credentials) {
      
        if (!credentials?.email || !credentials?.password) {
          return null
        }

        const user = await getUserByEmail(credentials.email as string)
        console.log('authorize getUserByEmail', user)

        if (!user) {
          return null
        }

        // Dans un environnement de production, vous devriez comparer avec un mot de passe hashé
        if (credentials.password !== user.password) {
          return null
        }
        console.log('authorize password ok', user)

        return {
          id: user.id,
          email: user.email,
          name: user.name,
          role: user.role,
        }
      },
    }),
  ],
```

Fichiers

- `lib/auth-config.ts`
- `(auth)/actions.ts`

## Aller plus loin

📑 Le lien vers la doc [https://www.w3schools.com/html/html_css.asp](https://www.w3schools.com/html/html_css.asp)

## Ils vont t’aider

- **🐶  Mowgli le Chien** : *Mowgli te guidera dans chaque exercice.*
- **🤖  Ash le Robot** : *Ash le Robot te donnera du code utile.*
- **🚀 Julia La roquette** : *Julia te donnera des défis supplémentaires.*
- **⛏️ Hulk le Marteau** : *Quand du code à supprimer est présent*
- **👨‍✈️ Hugo le chef de projet** : *Va t'aider sur les spécifications du projet*